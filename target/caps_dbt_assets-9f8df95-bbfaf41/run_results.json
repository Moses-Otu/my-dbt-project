{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2025-03-31T15:55:48.976691Z", "invocation_id": "9cc62d54-73e9-4774-bac4-6aee90e18be3", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:28.243383Z", "completed_at": "2025-03-31T15:55:28.622149Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:28.817370Z", "completed_at": "2025-03-31T15:55:34.227769Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 6.785940647125244, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb60fb-0002-9ce7-0007-966e0003e3c2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.caps.dim_listings_cleansed", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__src_listings as (\nWITH raw_listings AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        AIRBNB.RAW.RAW_LISTINGS\r\n)\r\nSELECT\r\n\r\n    id AS listing_id,\r\n    name AS hotel_name,\r\n    listing_url as hotel_url,\r\n    room_type,\r\n    minimum_nights,\r\n    host_id,\r\n    price ,\r\n    cast(created_at as date) as created_at,\r\n    cast(updated_at as date) as updated_at,\r\n\r\nFROM\r\n    raw_listings\n), src_listings AS (\n  SELECT\n    *\n  FROM\n    __dbt__cte__src_listings\n)\nSELECT\n  MD5(CONCAT(listing_id, created_at)) AS listing_sk,\n  listing_id,\n  hotel_name,\n  room_type,\n  CASE\n    WHEN minimum_nights = 0 THEN 1\n    ELSE minimum_nights\n  END AS minimum_nights,\n  host_id,\n  price,\n  created_at,\n  updated_at\nFROM\n  src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:28.171550Z", "completed_at": "2025-03-31T15:55:28.530335Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:28.610353Z", "completed_at": "2025-03-31T15:55:34.336184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.919492721557617, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb60fb-0002-9ce9-0007-966e0003c4a2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.caps.dim_owners_cleansed", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n       AIRBNB.RAW.RAW_HOSTS\r\n)\r\nSELECT\r\n    id AS host_id,\r\n    NAME AS owner_name,\r\n    is_superhost,\r\n    cast(created_at as date) AS created_at,\r\n    cast(updated_at as date) AS updated_at\r\nFROM\r\n    raw_hosts\n), src_hosts AS (\n    SELECT\n        *\n    FROM\n        __dbt__cte__src_hosts\n)\nSELECT\n    MD5(CONCAT(host_id, created_at)) AS host_sk,\n    host_id,\n    owner_name,\n    is_superhost,\n    created_at,\n    updated_at\nFROM\n    src_hosts", "relation_name": "AIRBNB.DEV.dim_owners_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:27.518332Z", "completed_at": "2025-03-31T15:55:27.518354Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:27.532385Z", "completed_at": "2025-03-31T15:55:37.117789Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 10.342824935913086, "adapter_response": {"_message": "INSERT 60", "code": "INSERT", "rows_affected": 60}, "message": "INSERT 60", "failures": null, "unique_id": "seed.caps.festive_holidays_past_10_years", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:36.351715Z", "completed_at": "2025-03-31T15:55:36.429451Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:36.437708Z", "completed_at": "2025-03-31T15:55:39.183758Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.646167516708374, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb60fb-0002-9ce8-0007-966e0003b4ce"}, "message": null, "failures": 0, "unique_id": "test.caps.not_null_dim_owners_cleansed_host_sk.052834c673", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_sk\nfrom AIRBNB.DEV.dim_owners_cleansed\nwhere host_sk is null\n\n\n", "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:37.786076Z", "completed_at": "2025-03-31T15:55:37.830557Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:38.207737Z", "completed_at": "2025-03-31T15:55:40.825596Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.6898131370544434, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb60fb-0002-9cce-0007-966e0003d45a"}, "message": null, "failures": 0, "unique_id": "test.caps.unique_dim_owners_cleansed_host_sk.93cc0ebdaf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    host_sk as unique_field,\n    count(*) as n_records\n\nfrom AIRBNB.DEV.dim_owners_cleansed\nwhere host_sk is not null\ngroup by host_sk\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:28.045461Z", "completed_at": "2025-03-31T15:55:28.642574Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:28.999230Z", "completed_at": "2025-03-31T15:55:41.312194Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 13.847272872924805, "adapter_response": {"_message": "SUCCESS 5108", "code": "SUCCESS", "rows_affected": 5108, "query_id": "01bb60fb-0002-9ce7-0007-966e0003e3d2"}, "message": "SUCCESS 5108", "failures": null, "unique_id": "model.caps.fct_reviews", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__src_reviews as (\nWITH raw_reviews AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        AIRBNB.RAW.RAW_REVIEWS\r\n)\r\nSELECT\r\n    listing_id,\r\n    cast(date as Date) AS review_date,\r\n    reviewer_name,\r\n    comments AS review_text,\r\n    sentiment AS review_sentiment\r\nFROM\r\n    raw_reviews\n), src_reviews AS (\n  SELECT * FROM __dbt__cte__src_reviews\n)\nSELECT * FROM src_reviews\nWHERE review_text is not null\n\n\n  AND review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)\n", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:28.324794Z", "completed_at": "2025-03-31T15:55:28.433466Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:28.448100Z", "completed_at": "2025-03-31T15:55:42.259375Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 14.89236569404602, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01bb60fb-0002-9cea-0007-966e0003a566"}, "message": "SUCCESS 0", "failures": null, "unique_id": "snapshot.caps.scd_raw_listings", "compiled": true, "compiled_code": "\n\n\n\n\nwith __dbt__cte__src_listings as (\nWITH raw_listings AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        AIRBNB.RAW.RAW_LISTINGS\r\n)\r\nSELECT\r\n\r\n    id AS listing_id,\r\n    name AS hotel_name,\r\n    listing_url as hotel_url,\r\n    room_type,\r\n    minimum_nights,\r\n    host_id,\r\n    price ,\r\n    cast(created_at as date) as created_at,\r\n    cast(updated_at as date) as updated_at,\r\n\r\nFROM\r\n    raw_listings\n) SELECT \n    listing_id,hotel_name,hotel_url,room_type,minimum_nights,host_id,price,created_at,\n    updated_at::TIMESTAMP_NTZ AS updated_at  -- Ensure it's the correct datatype\nFROM __dbt__cte__src_listings\n", "relation_name": "AIRBNB.DEV.scd_raw_listings"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:34.885185Z", "completed_at": "2025-03-31T15:55:34.923603Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:35.845452Z", "completed_at": "2025-03-31T15:55:43.998513Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 9.752639532089233, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01bb60fb-0002-9cce-0007-966e0003d46a"}, "message": "SUCCESS 0", "failures": null, "unique_id": "snapshot.caps.scd_raw_hosts", "compiled": true, "compiled_code": "\n\n\n\n\nwith __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n       AIRBNB.RAW.RAW_HOSTS\r\n)\r\nSELECT\r\n    id AS host_id,\r\n    NAME AS owner_name,\r\n    is_superhost,\r\n    cast(created_at as date) AS created_at,\r\n    cast(updated_at as date) AS updated_at\r\nFROM\r\n    raw_hosts\n) SELECT \n    host_id,owner_name,is_superhost,created_at,\n    updated_at::TIMESTAMP_NTZ AS updated_at  -- Ensure it's the correct datatype\nFROM __dbt__cte__src_hosts\n", "relation_name": "AIRBNB.DEV.scd_raw_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:41.492937Z", "completed_at": "2025-03-31T15:55:41.514493Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:41.741774Z", "completed_at": "2025-03-31T15:55:44.380755Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.4259824752807617, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb60fb-0002-9ce8-0007-966e0003b4de"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.caps.dim_listings_w_owners", "compiled": true, "compiled_code": "WITH\nl AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.DEV.dim_listings_cleansed\n),\nh AS (\n    SELECT * \n    FROM AIRBNB.DEV.dim_owners_cleansed\n)\n\nSELECT\n    l.listing_sk,\n    l.listing_id,\n    l.hotel_name,\n    l.room_type,\n    l.minimum_nights,\n    l.price,\n    l.host_id,\n    h.host_sk,\n    h.owner_name,\n    h.is_superhost as host_is_superhost,\n    l.created_at,\n    GREATEST(l.updated_at, h.updated_at) as updated_at\nFROM l\nLEFT JOIN h ON (h.host_id = l.host_id)", "relation_name": "AIRBNB.DEV.dim_listings_w_owners"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:41.858223Z", "completed_at": "2025-03-31T15:55:41.884711Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:42.284785Z", "completed_at": "2025-03-31T15:55:47.810123Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 6.503011703491211, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb60fb-0002-9ce8-0007-966e0003b4e2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.caps.holiday_reviews", "compiled": true, "compiled_code": "\n\nWITH fct_reviews AS (\n    SELECT * FROM AIRBNB.DEV.fct_reviews\n),\nholiday_dates AS (\n    SELECT DISTINCT Date AS holiday_date,holiday FROM AIRBNB.DEV.festive_holidays_past_10_years\n)\n\nSELECT \n    r.listing_id,\n    r.review_date,\n    r.reviewer_name,\n    r.review_text,\n    r.review_sentiment,\n    CASE \n        WHEN d.holiday_date IS NOT NULL THEN 'Y'\n        ELSE 'N'\n    END AS is_holiday,\n    d.holiday\nFROM fct_reviews r\nLEFT JOIN holiday_dates d \n    ON r.review_date = d.holiday_date", "relation_name": "AIRBNB.DEV.holiday_reviews"}, {"status": "fail", "timing": [{"name": "compile", "started_at": "2025-03-31T15:55:45.010885Z", "completed_at": "2025-03-31T15:55:45.041850Z"}, {"name": "execute", "started_at": "2025-03-31T15:55:45.588797Z", "completed_at": "2025-03-31T15:55:47.785693Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.351808786392212, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb60fb-0002-9cea-0007-966e0003a572"}, "message": "Got 577 results, configured to fail if != 0", "failures": 577, "unique_id": "test.caps.relationships_dim_owners_cleansed_host_sk__host_sk__ref_dim_listings_w_owners_.741992f4c6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select host_sk as from_field\n    from AIRBNB.DEV.dim_owners_cleansed\n    where host_sk is not null\n),\n\nparent as (\n    select host_sk as to_field\n    from AIRBNB.DEV.dim_listings_w_owners\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}], "elapsed_time": 29.674020767211914, "args": {"introspect": true, "favor_state": false, "log_level": "info", "profiles_dir": "C:\\Users\\crypt\\.dbt", "indirect_selection": "eager", "partial_parse_file_diff": true, "write_json": true, "show_resource_report": false, "log_format": "json", "show": false, "log_file_max_bytes": 10485760, "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": false, "quiet": false, "strict_mode": false, "target_path": "target\\caps_dbt_assets-9f8df95-bbfaf41", "use_colors_file": true, "vars": {}, "version_check": true, "enable_legacy_logger": false, "defer": false, "include_saved_query": false, "send_anonymous_usage_stats": false, "log_path": "C:\\Users\\crypt\\OneDrive\\Desktop\\capstoneair\\capstone\\dbt\\target\\caps_dbt_assets-9f8df95-bbfaf41", "static_parser": true, "project_dir": "C:\\Users\\crypt\\OneDrive\\Desktop\\capstoneair\\capstone\\dbt", "debug": true, "use_colors": true, "partial_parse": true, "printer_width": 80, "exclude": [], "invocation_command": "dbt build --select fqn:*", "macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "which": "build", "print": true, "select": ["fqn:*"], "populate_cache": true, "resource_types": [], "log_format_file": "json", "log_level_file": "debug"}}