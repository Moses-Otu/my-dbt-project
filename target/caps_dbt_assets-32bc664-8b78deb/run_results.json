{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2025-03-31T17:03:00.428548Z", "invocation_id": "09f81933-cbea-4d54-9ef1-047618ea86af", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T17:02:42.872952Z", "completed_at": "2025-03-31T17:02:43.000227Z"}, {"name": "execute", "started_at": "2025-03-31T17:02:43.183851Z", "completed_at": "2025-03-31T17:02:46.261980Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.020450592041016, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb613e-0002-9ce9-0007-966e0003c4ea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.caps.dim_owners_cleansed", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n       AIRBNB.RAW.RAW_HOSTS\r\n)\r\nSELECT\r\n    id AS host_id,\r\n    NAME AS owner_name,\r\n    is_superhost,\r\n    cast(created_at as date) AS created_at,\r\n    cast(updated_at as date) AS updated_at\r\nFROM\r\n    raw_hosts\n), src_hosts AS (\n    SELECT\n        *\n    FROM\n        __dbt__cte__src_hosts\n)\nSELECT\n    MD5(CONCAT(host_id, created_at)) AS host_sk,\n    host_id,\n    owner_name,\n    is_superhost,\n    created_at,\n    updated_at\nFROM\n    src_hosts", "relation_name": "AIRBNB.DEV.dim_owners_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T17:02:42.774091Z", "completed_at": "2025-03-31T17:02:43.038287Z"}, {"name": "execute", "started_at": "2025-03-31T17:02:43.282152Z", "completed_at": "2025-03-31T17:02:46.313815Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 4.232550144195557, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb613e-0002-9ce7-0007-966e0003e406"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.caps.dim_listings_cleansed", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__src_listings as (\nWITH raw_listings AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        AIRBNB.RAW.RAW_LISTINGS\r\n)\r\nSELECT\r\n\r\n    id AS listing_id,\r\n    name AS hotel_name,\r\n    listing_url as hotel_url,\r\n    room_type,\r\n    minimum_nights,\r\n    host_id,\r\n    price ,\r\n    cast(created_at as date) as created_at,\r\n    cast(updated_at as date) as updated_at,\r\n\r\nFROM\r\n    raw_listings\n), src_listings AS (\n  SELECT\n    *\n  FROM\n    __dbt__cte__src_listings\n)\nSELECT\n  MD5(CONCAT(listing_id, created_at)) AS listing_sk,\n  listing_id,\n  hotel_name,\n  room_type,\n  CASE\n    WHEN minimum_nights = 0 THEN 1\n    ELSE minimum_nights\n  END AS minimum_nights,\n  host_id,\n  price,\n  created_at,\n  updated_at\nFROM\n  src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T17:02:42.450532Z", "completed_at": "2025-03-31T17:02:42.450567Z"}, {"name": "execute", "started_at": "2025-03-31T17:02:42.466461Z", "completed_at": "2025-03-31T17:02:49.447733Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 7.689494609832764, "adapter_response": {"_message": "INSERT 60", "code": "INSERT", "rows_affected": 60}, "message": "INSERT 60", "failures": null, "unique_id": "seed.caps.festive_holidays_past_10_years", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-03-31T17:02:48.007901Z", "completed_at": "2025-03-31T17:02:48.087986Z"}, {"name": "execute", "started_at": "2025-03-31T17:02:48.100395Z", "completed_at": "2025-03-31T17:02:50.584572Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.206282615661621, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb613e-0002-9ce8-0007-966e0003b53e"}, "message": null, "failures": 0, "unique_id": "test.caps.not_null_dim_owners_cleansed_host_id.4d389d4f7d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom AIRBNB.DEV.dim_owners_cleansed\nwhere host_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T17:02:42.812747Z", "completed_at": "2025-03-31T17:02:42.837965Z"}, {"name": "execute", "started_at": "2025-03-31T17:02:42.908532Z", "completed_at": "2025-03-31T17:02:52.206368Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 9.971590995788574, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01bb613e-0002-9cce-0007-966e0003d4aa"}, "message": "SUCCESS 0", "failures": null, "unique_id": "snapshot.caps.scd_raw_listings", "compiled": true, "compiled_code": "\n\n\n\n\nwith __dbt__cte__src_listings as (\nWITH raw_listings AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        AIRBNB.RAW.RAW_LISTINGS\r\n)\r\nSELECT\r\n\r\n    id AS listing_id,\r\n    name AS hotel_name,\r\n    listing_url as hotel_url,\r\n    room_type,\r\n    minimum_nights,\r\n    host_id,\r\n    price ,\r\n    cast(created_at as date) as created_at,\r\n    cast(updated_at as date) as updated_at,\r\n\r\nFROM\r\n    raw_listings\n) SELECT \n    listing_id,hotel_name,hotel_url,room_type,minimum_nights,host_id,price,created_at,\n    updated_at::TIMESTAMP_NTZ AS updated_at  -- Ensure it's the correct datatype\nFROM __dbt__cte__src_listings\n", "relation_name": "AIRBNB.DEV.scd_raw_listings"}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-03-31T17:02:50.106148Z", "completed_at": "2025-03-31T17:02:50.154512Z"}, {"name": "execute", "started_at": "2025-03-31T17:02:50.600192Z", "completed_at": "2025-03-31T17:02:52.367356Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.768700122833252, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb613e-0002-9cce-0007-966e0003d4b6"}, "message": null, "failures": 0, "unique_id": "test.caps.unique_dim_owners_cleansed_host_id.c262997d85", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    host_id as unique_field,\n    count(*) as n_records\n\nfrom AIRBNB.DEV.dim_owners_cleansed\nwhere host_id is not null\ngroup by host_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T17:02:42.845326Z", "completed_at": "2025-03-31T17:02:42.997243Z"}, {"name": "execute", "started_at": "2025-03-31T17:02:43.156789Z", "completed_at": "2025-03-31T17:02:52.291654Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 10.143270492553711, "adapter_response": {"_message": "SUCCESS 5108", "code": "SUCCESS", "rows_affected": 5108, "query_id": "01bb613e-0002-9cea-0007-966e0003a58e"}, "message": "SUCCESS 5108", "failures": null, "unique_id": "model.caps.fct_reviews", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__src_reviews as (\nWITH raw_reviews AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        AIRBNB.RAW.RAW_REVIEWS\r\n)\r\nSELECT\r\n    listing_id,\r\n    cast(date as Date) AS review_date,\r\n    reviewer_name,\r\n    comments AS review_text,\r\n    sentiment AS review_sentiment\r\nFROM\r\n    raw_reviews\n), src_reviews AS (\n  SELECT * FROM __dbt__cte__src_reviews\n)\nSELECT * FROM src_reviews\nWHERE review_text is not null\n\n\n  AND review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)\n", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T17:02:46.794726Z", "completed_at": "2025-03-31T17:02:46.818412Z"}, {"name": "execute", "started_at": "2025-03-31T17:02:47.552385Z", "completed_at": "2025-03-31T17:02:55.381812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 9.129653692245483, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01bb613e-0002-9cea-0007-966e0003a59a"}, "message": "SUCCESS 0", "failures": null, "unique_id": "snapshot.caps.scd_raw_hosts", "compiled": true, "compiled_code": "\n\n\n\n\nwith __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n       AIRBNB.RAW.RAW_HOSTS\r\n)\r\nSELECT\r\n    id AS host_id,\r\n    NAME AS owner_name,\r\n    is_superhost,\r\n    cast(created_at as date) AS created_at,\r\n    cast(updated_at as date) AS updated_at\r\nFROM\r\n    raw_hosts\n) SELECT \n    host_id,owner_name,is_superhost,created_at,\n    updated_at::TIMESTAMP_NTZ AS updated_at  -- Ensure it's the correct datatype\nFROM __dbt__cte__src_hosts\n", "relation_name": "AIRBNB.DEV.scd_raw_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T17:02:53.120427Z", "completed_at": "2025-03-31T17:02:53.357599Z"}, {"name": "execute", "started_at": "2025-03-31T17:02:53.853310Z", "completed_at": "2025-03-31T17:02:56.560625Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 4.214513778686523, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb613e-0002-9ce9-0007-966e0003c506"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.caps.dim_listings_w_owners", "compiled": true, "compiled_code": "WITH\nl AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.DEV.dim_listings_cleansed\n),\nh AS (\n    SELECT * \n    FROM AIRBNB.DEV.dim_owners_cleansed\n)\n\nSELECT\n    l.listing_sk,\n    l.listing_id,\n    l.hotel_name,\n    l.room_type,\n    l.minimum_nights,\n    l.price,\n    l.host_id,\n    h.host_sk,\n    h.owner_name,\n    h.is_superhost as host_is_superhost,\n    l.created_at,\n    GREATEST(l.updated_at, h.updated_at) as updated_at\nFROM l\nLEFT JOIN h ON (h.host_id = l.host_id)", "relation_name": "AIRBNB.DEV.dim_listings_w_owners"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-31T17:02:53.871941Z", "completed_at": "2025-03-31T17:02:53.969035Z"}, {"name": "execute", "started_at": "2025-03-31T17:02:53.984460Z", "completed_at": "2025-03-31T17:02:59.915790Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 6.583833932876587, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb613e-0002-9cea-0007-966e0003a59e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.caps.holiday_reviews", "compiled": true, "compiled_code": "\n\nWITH fct_reviews AS (\n    SELECT * FROM AIRBNB.DEV.fct_reviews\n),\nholiday_dates AS (\n    SELECT DISTINCT Date AS holiday_date,holiday FROM AIRBNB.DEV.festive_holidays_past_10_years\n)\n\nSELECT \n    r.listing_id,\n    r.review_date,\n    r.reviewer_name,\n    r.review_text,\n    r.review_sentiment,\n    CASE \n        WHEN d.holiday_date IS NOT NULL THEN 'Y'\n        ELSE 'N'\n    END AS is_holiday,\n    d.holiday\nFROM fct_reviews r\nLEFT JOIN holiday_dates d \n    ON r.review_date = d.holiday_date", "relation_name": "AIRBNB.DEV.holiday_reviews"}], "elapsed_time": 23.27511477470398, "args": {"macro_debugging": false, "show": false, "log_level": "info", "enable_legacy_logger": false, "printer_width": 80, "use_colors": true, "which": "build", "partial_parse_file_diff": true, "vars": {}, "select": ["fqn:*"], "partial_parse": true, "static_parser": true, "introspect": true, "project_dir": "C:\\Users\\crypt\\OneDrive\\Desktop\\capstoneair\\capstone\\dbt", "invocation_command": "dbt build --select fqn:*", "quiet": false, "warn_error_options": {"include": [], "exclude": []}, "target_path": "target\\caps_dbt_assets-32bc664-8b78deb", "log_path": "C:\\Users\\crypt\\OneDrive\\Desktop\\capstoneair\\capstone\\dbt\\target\\caps_dbt_assets-32bc664-8b78deb", "log_file_max_bytes": 10485760, "defer": false, "write_json": true, "version_check": true, "require_explicit_package_overrides_for_builtin_materializations": false, "debug": true, "log_level_file": "debug", "cache_selected_only": false, "resource_types": [], "send_anonymous_usage_stats": false, "strict_mode": false, "log_format_file": "json", "favor_state": false, "indirect_selection": "eager", "log_format": "json", "show_resource_report": false, "use_colors_file": true, "exclude": [], "print": true, "profiles_dir": "C:\\Users\\crypt\\.dbt", "populate_cache": true, "include_saved_query": false}}