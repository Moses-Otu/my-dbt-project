{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2025-04-01T16:57:14.519217Z", "invocation_id": "c3d60cdf-a633-40fb-892a-ab8081825c27", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-01T16:57:14.387904Z", "completed_at": "2025-04-01T16:57:14.390404Z"}, {"name": "execute", "started_at": "2025-04-01T16:57:14.395338Z", "completed_at": "2025-04-01T16:57:14.395357Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.022564172744750977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.caps.festive_holidays_past_10_years", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-01T16:57:14.435935Z", "completed_at": "2025-04-01T16:57:14.442094Z"}, {"name": "execute", "started_at": "2025-04-01T16:57:14.457284Z", "completed_at": "2025-04-01T16:57:14.457298Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.043328285217285156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.caps.scd_raw_hosts", "compiled": true, "compiled_code": "\n\n\n\n\nwith __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n       AIRBNB.RAW.RAW_HOSTS\r\n)\r\nSELECT\r\n    id AS host_id,\r\n    NAME AS owner_name,\r\n    is_superhost,\r\n    cast(created_at as date) AS created_at,\r\n    cast(updated_at as date) AS updated_at\r\nFROM\r\n    raw_hosts\n) SELECT \n    host_id,owner_name,is_superhost,created_at,\n    updated_at::TIMESTAMP_NTZ AS updated_at  -- Ensure it's the correct datatype\nFROM __dbt__cte__src_hosts\n", "relation_name": "AIRBNB.DEV.scd_raw_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-01T16:57:14.442943Z", "completed_at": "2025-04-01T16:57:14.447011Z"}, {"name": "execute", "started_at": "2025-04-01T16:57:14.457880Z", "completed_at": "2025-04-01T16:57:14.457892Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.043578386306762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.caps.scd_raw_listings", "compiled": true, "compiled_code": "\n\n\n\n\nwith __dbt__cte__src_listings as (\nWITH raw_listings AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        AIRBNB.RAW.RAW_LISTINGS\r\n)\r\nSELECT\r\n\r\n    id AS listing_id,\r\n    name AS hotel_name,\r\n    listing_url as hotel_url,\r\n    room_type,\r\n    minimum_nights,\r\n    host_id,\r\n    price ,\r\n    cast(created_at as date) as created_at,\r\n    cast(updated_at as date) as updated_at,\r\n\r\nFROM\r\n    raw_listings\n) SELECT \n    listing_id,hotel_name,hotel_url,room_type,minimum_nights,host_id,price,created_at,\n    updated_at::TIMESTAMP_NTZ AS updated_at  -- Ensure it's the correct datatype\nFROM __dbt__cte__src_listings\n", "relation_name": "AIRBNB.DEV.scd_raw_listings"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-01T16:57:14.428056Z", "completed_at": "2025-04-01T16:57:14.458454Z"}, {"name": "execute", "started_at": "2025-04-01T16:57:14.462880Z", "completed_at": "2025-04-01T16:57:14.462887Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04880356788635254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caps.dim_listings_cleansed", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__src_listings as (\nWITH raw_listings AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        AIRBNB.RAW.RAW_LISTINGS\r\n)\r\nSELECT\r\n\r\n    id AS listing_id,\r\n    name AS hotel_name,\r\n    listing_url as hotel_url,\r\n    room_type,\r\n    minimum_nights,\r\n    host_id,\r\n    price ,\r\n    cast(created_at as date) as created_at,\r\n    cast(updated_at as date) as updated_at,\r\n\r\nFROM\r\n    raw_listings\n), src_listings AS (\n  SELECT\n    *\n  FROM\n    __dbt__cte__src_listings\n)\nSELECT\n  MD5(CONCAT(listing_id, created_at)) AS listing_sk,\n  listing_id,\n  hotel_name,\n  room_type,\n  CASE\n    WHEN minimum_nights = 0 THEN 1\n    ELSE minimum_nights\n  END AS minimum_nights,\n  host_id,\n  price,\n  created_at,\n  updated_at\nFROM\n  src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-01T16:57:14.421199Z", "completed_at": "2025-04-01T16:57:14.458856Z"}, {"name": "execute", "started_at": "2025-04-01T16:57:14.463813Z", "completed_at": "2025-04-01T16:57:14.463820Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.051413536071777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caps.dim_owners_cleansed", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n       AIRBNB.RAW.RAW_HOSTS\r\n)\r\nSELECT\r\n    id AS host_id,\r\n    NAME AS owner_name,\r\n    is_superhost,\r\n    cast(created_at as date) AS created_at,\r\n    cast(updated_at as date) AS updated_at\r\nFROM\r\n    raw_hosts\n), src_hosts AS (\n    SELECT\n        *\n    FROM\n        __dbt__cte__src_hosts\n)\nSELECT\n    MD5(CONCAT(host_id, created_at)) AS host_sk,\n    host_id,\n    owner_name,\n    is_superhost,\n    created_at,\n    updated_at\nFROM\n    src_hosts", "relation_name": "AIRBNB.DEV.dim_owners_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-01T16:57:14.447604Z", "completed_at": "2025-04-01T16:57:14.461837Z"}, {"name": "execute", "started_at": "2025-04-01T16:57:14.465134Z", "completed_at": "2025-04-01T16:57:14.465142Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04892706871032715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caps.fct_reviews", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__src_reviews as (\nWITH raw_reviews AS (\r\n    SELECT\r\n        *\r\n    FROM\r\n        AIRBNB.RAW.RAW_REVIEWS\r\n)\r\nSELECT\r\n    listing_id,\r\n    cast(date as Date) AS review_date,\r\n    reviewer_name,\r\n    comments AS review_text,\r\n    sentiment AS review_sentiment\r\nFROM\r\n    raw_reviews\n), src_reviews AS (\n  SELECT * FROM __dbt__cte__src_reviews\n)\nSELECT * FROM src_reviews\nWHERE review_text is not null\n\n\n  AND review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)\n", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-01T16:57:14.470835Z", "completed_at": "2025-04-01T16:57:14.501411Z"}, {"name": "execute", "started_at": "2025-04-01T16:57:14.502547Z", "completed_at": "2025-04-01T16:57:14.502557Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03503990173339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caps.not_null_dim_owners_cleansed_host_id.4d389d4f7d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom AIRBNB.DEV.dim_owners_cleansed\nwhere host_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-01T16:57:14.498919Z", "completed_at": "2025-04-01T16:57:14.505772Z"}, {"name": "execute", "started_at": "2025-04-01T16:57:14.510161Z", "completed_at": "2025-04-01T16:57:14.510171Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.028203964233398438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caps.dim_listings_w_owners", "compiled": true, "compiled_code": "WITH\nl AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.DEV.dim_listings_cleansed\n),\nh AS (\n    SELECT * \n    FROM AIRBNB.DEV.dim_owners_cleansed\n)\n\nSELECT\n    l.listing_sk,\n    l.listing_id,\n    l.hotel_name,\n    l.room_type,\n    l.minimum_nights,\n    l.price,\n    l.host_id,\n    h.host_sk,\n    h.owner_name,\n    h.is_superhost as host_is_superhost,\n    l.created_at,\n    GREATEST(l.updated_at, h.updated_at) as updated_at\nFROM l\nLEFT JOIN h ON (h.host_id = l.host_id)", "relation_name": "AIRBNB.DEV.dim_listings_w_owners"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-01T16:57:14.486887Z", "completed_at": "2025-04-01T16:57:14.506594Z"}, {"name": "execute", "started_at": "2025-04-01T16:57:14.510937Z", "completed_at": "2025-04-01T16:57:14.510951Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.03111720085144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.caps.unique_dim_owners_cleansed_host_id.c262997d85", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    host_id as unique_field,\n    count(*) as n_records\n\nfrom AIRBNB.DEV.dim_owners_cleansed\nwhere host_id is not null\ngroup by host_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-01T16:57:14.496251Z", "completed_at": "2025-04-01T16:57:14.507224Z"}, {"name": "execute", "started_at": "2025-04-01T16:57:14.511750Z", "completed_at": "2025-04-01T16:57:14.511765Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0312650203704834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.caps.holiday_reviews", "compiled": true, "compiled_code": "\n\nWITH fct_reviews AS (\n    SELECT * FROM AIRBNB.DEV.fct_reviews\n),\nholiday_dates AS (\n    SELECT DISTINCT Date AS holiday_date,holiday FROM AIRBNB.DEV.festive_holidays_past_10_years\n)\n\nSELECT \n    r.listing_id,\n    r.review_date,\n    r.reviewer_name,\n    r.review_text,\n    r.review_sentiment,\n    CASE \n        WHEN d.holiday_date IS NOT NULL THEN 'Y'\n        ELSE 'N'\n    END AS is_holiday,\n    d.holiday\nFROM fct_reviews r\nLEFT JOIN holiday_dates d \n    ON r.review_date = d.holiday_date", "relation_name": "AIRBNB.DEV.holiday_reviews"}], "elapsed_time": 8.692839622497559, "args": {"log_format": "default", "introspect": true, "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "write_json": true, "defer": false, "log_level": "info", "static": false, "send_anonymous_usage_stats": true, "cache_selected_only": false, "printer_width": 80, "enable_legacy_logger": false, "log_level_file": "debug", "static_parser": true, "partial_parse_file_diff": true, "strict_mode": false, "favor_state": false, "log_file_max_bytes": 10485760, "exclude": [], "version_check": true, "use_colors_file": true, "profiles_dir": "C:\\Users\\crypt\\.dbt", "use_colors": true, "vars": {}, "which": "generate", "project_dir": "C:\\Users\\crypt\\OneDrive\\Desktop\\capstoneair\\capstone\\dbt", "show_resource_report": false, "compile": true, "quiet": false, "partial_parse": true, "empty_catalog": false, "require_explicit_package_overrides_for_builtin_materializations": false, "invocation_command": "dbt docs generate", "select": [], "print": true, "macro_debugging": false, "log_path": "C:\\Users\\crypt\\OneDrive\\Desktop\\capstoneair\\capstone\\dbt\\logs", "log_format_file": "debug"}}